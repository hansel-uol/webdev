{% extends "base.html" %}
{% block content %}
<div class="container">
    <div id="add">
        <div class="row m-3">
            <div class="col-12">
                <a href="/income" class="btn btn-success btn-block p-2" role="button" aria-pressed="true">Add Income</a>
            </div>
        </div>

        <div class="row m-3">
            <div class="col-12">
                <a href="/expenditure" class="btn btn-danger btn-block p-2" role="button" aria-pressed="true">Add Expenditure</a>
            </div>
        </div>
    </div>

    <br>
            <!-- Conditional Render -->
        <!-- <div class="col-sm text-center">
            <div class="card text-white bg-danger mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Expenditure:</h5>
                    <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                </div>
            </div>
        </div> -->

        {% if income_and_expenditure %}
            <table class="table table-bordered table-dark">
                <thead>
                    <tr>
                        <th scope="col">Type</th>
                        <th scope="col">Name</th>
                        <th scope="col">Action</th>
                        <th scope="col">Amount (£)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in income_and_expenditure %}
                        {% if result.__tablename__ == 'income' %}
                            <tr>
                                <th scope="row" class="income">Income</th>
                                <td>{{ result.name }}</td>
                                <td>
                                    <a href="{{ url_for('update_entry', entry_type='income', id=result.id) }}" class="btn btn-warning">Edit</a>
                                    <a href="{{ url_for('delete_entry', entry_type='income', id=result.id) }}" class="btn btn-danger">Delete</a>
                                </td>
                                <td class="text-center">{{ result.amount }}</td>
                            </tr>
                        {% elif result.__tablename__ == 'expenditure' %}
                            <tr>
                                <th scope="row" class="expenditure">Expenditure</th>
                                <td>{{ result.name }}</td>
                                <td>
                                    <a href="{{ url_for('update_entry', entry_type='expenditure', id=result.id) }}" class="btn btn-warning">Edit</a>
                                    <a href="{{ url_for('delete_entry', entry_type='expenditure', id=result.id) }}" class="btn btn-danger">Delete</a>
                                </td>
                                <td class="text-center">{{ result.amount }}</td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}

    <br>

    <div class="row">
        <div class="col-sm text-center">
            <div class="card text-white bg-success mb-3" >
                <div class="card-body">
                    <h5 class="card-title">Total Income (£):</h5>
                    <p class="card-text">
                        {{ total_income }}
                    </p>
                </div>
            </div>
        </div>
            
        <div class="col-sm text-center">
            <div class="card text-white bg-danger mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Expenditure (£):</h5>
                    <p class="card-text">
                        {{ total_expenditure }}
                    </p>
                </div>
            </div>
        </div>
    </div>

        <!-- Renders either a surplus/deficit depending on the net difference of income and expenditure -->
    <div class="row">
        <div class="col text-center">
            <div class="card text-white 
            {% if total_difference < 0 %}
             bg-danger 
            {% elif total_difference > 0 %}
            bg-success
            {% else %}
            bg-info
            {% endif %} mb-3">
                <div class="card-body">
                    <h5 class="card-title">
                        {% if total_difference < 0 %}
                            Deficit
                        {% else %}
                            Surplus
                        {% endif %}
                        (£):
                    </h5>
                    <p class="card-text">
                        {% if total_difference < 0 %}
                            {{ total_difference * -1 }}
                        {% else %}
                            {{ total_difference }}
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>
        
        

</div>
{% endblock %}